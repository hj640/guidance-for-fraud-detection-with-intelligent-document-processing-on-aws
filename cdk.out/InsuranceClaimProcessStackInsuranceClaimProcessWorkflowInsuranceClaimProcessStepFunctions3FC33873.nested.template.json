{
 "Metadata": {
  "cdk_nag": {
   "rules_to_suppress": [
    {
     "reason": "Server Access Logging is not required for non-production code.",
     "id": "AwsSolutions-S1"
    },
    {
     "reason": "Managed policies are acceptable for non-production code.",
     "id": "AwsSolutions-IAM4"
    },
    {
     "reason": "IAM policies are with '*' resources have been reviewed that they only have access to log destinations or resource names have prefixes.",
     "id": "AwsSolutions-IAM5"
    },
    {
     "reason": "Lambda functions have dependencies on Python 3.11",
     "id": "AwsSolutions-L1"
    },
    {
     "reason": "Token-based API is acceptable for non-production code.",
     "id": "AwsSolutions-COG1"
    },
    {
     "reason": "User pool is acceptable for non-production code.",
     "id": "AwsSolutions-COG2"
    },
    {
     "reason": "User pool is acceptable for non-production code.",
     "id": "AwsSolutions-COG3"
    },
    {
     "reason": "Access logging is acceptable for non-production code.",
     "id": "AwsSolutions-APIG1"
    },
    {
     "reason": "Request validation is acceptable for non-production code.",
     "id": "AwsSolutions-APIG2"
    },
    {
     "reason": "WAF is acceptable for non-production code.",
     "id": "AwsSolutions-APIG3"
    },
    {
     "reason": "API keys are acceptable for non-production code.",
     "id": "AwsSolutions-APIG4"
    },
    {
     "reason": "Cognito user pool is acceptable for non-production code.",
     "id": "AwsSolutions-COG4"
    },
    {
     "reason": "API steps are acceptable for non-production code.",
     "id": "AwsSolutions-APIG6"
    },
    {
     "reason": "Step function is acceptable for non-production code.",
     "id": "AwsSolutions-SF1"
    },
    {
     "reason": "X-Ray is acceptable for non-production code.",
     "id": "AwsSolutions-SF2"
    },
    {
     "reason": "SNS topic is acceptable for non-production code.",
     "id": "AwsSolutions-SNS3"
    },
    {
     "reason": "The CloudFront distribution may require Geo restrictions",
     "id": "AwsSolutions-CFR1"
    },
    {
     "reason": "The Web Application Firewall",
     "id": "AwsSolutions-CFR2"
    },
    {
     "reason": "The CloudFront distribution allows for SSLv3 or TLSv1 for HTTPS viewer connections",
     "id": "AwsSolutions-CFR4"
    },
    {
     "reason": "The CloudFront distribution does not have an associated WAFWebACL",
     "id": "AwsSolutions-CFR7"
    },
    {
     "reason": "Point-in-time Recovery is acceptable for non-production code.",
     "id": "AwsSolutions-DDB3"
    }
   ]
  }
 },
 "Resources": {
  "insuranceclaimClaimProcessingsfnroleC70596EF": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "states.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "Policies": [
     {
      "PolicyDocument": {
       "Statement": [
        {
         "Action": "s3:ListBucket",
         "Effect": "Allow",
         "Resource": [
          {
           "Fn::Join": [
            "",
            [
             "arn:aws:s3:::insuranceclaim-input-",
             {
              "Ref": "AWS::AccountId"
             },
             "-",
             {
              "Ref": "AWS::Region"
             }
            ]
           ]
          },
          {
           "Fn::Join": [
            "",
            [
             "arn:aws:s3:::insuranceclaim-output-",
             {
              "Ref": "AWS::AccountId"
             },
             "-",
             {
              "Ref": "AWS::Region"
             }
            ]
           ]
          }
         ]
        },
        {
         "Action": [
          "s3:GetObject",
          "s3:PutObject"
         ],
         "Effect": "Allow",
         "Resource": [
          {
           "Fn::Join": [
            "",
            [
             "arn:aws:s3:::insuranceclaim-input-",
             {
              "Ref": "AWS::AccountId"
             },
             "-",
             {
              "Ref": "AWS::Region"
             },
             "/*"
            ]
           ]
          },
          {
           "Fn::Join": [
            "",
            [
             "arn:aws:s3:::insuranceclaim-output-",
             {
              "Ref": "AWS::AccountId"
             },
             "-",
             {
              "Ref": "AWS::Region"
             },
             "/*"
            ]
           ]
          }
         ]
        },
        {
         "Action": [
          "bedrock:GetDataAutomationStatus",
          "bedrock:InvokeDataAutomationAsync"
         ],
         "Effect": "Allow",
         "Resource": [
          "arn:aws:bedrock:us-east-1:730076539151:data-automation-project/30fafe32db59",
          {
           "Fn::Join": [
            "",
            [
             "arn:aws:bedrock:*:",
             {
              "Ref": "AWS::AccountId"
             },
             ":data-automation-invocation/*"
            ]
           ]
          },
          {
           "Fn::Join": [
            "",
            [
             "arn:aws:bedrock:*:",
             {
              "Ref": "AWS::AccountId"
             },
             ":data-automation-profile/*"
            ]
           ]
          }
         ]
        },
        {
         "Action": [
          "bedrock:InvokeModel",
          "bedrock:InvokeModelWithResponseStream"
         ],
         "Effect": "Allow",
         "Resource": {
          "Fn::Join": [
           "",
           [
            "arn:aws:bedrock:",
            {
             "Ref": "AWS::Region"
            },
            ":",
            {
             "Ref": "AWS::AccountId"
            },
            ":inference-profile/us.*"
           ]
          ]
         }
        },
        {
         "Action": [
          "bedrock:InvokeModel",
          "bedrock:InvokeModelWithResponseStream"
         ],
         "Condition": {
          "StringLike": {
           "bedrock:InferenceProfileArn": {
            "Fn::Join": [
             "",
             [
              "arn:aws:bedrock:us-east-1:",
              {
               "Ref": "AWS::AccountId"
              },
              ":inference-profile/us.*"
             ]
            ]
           }
          }
         },
         "Effect": "Allow",
         "Resource": [
          "arn:aws:bedrock:us-east-1::foundation-model/*",
          "arn:aws:bedrock:us-east-2::foundation-model/*",
          "arn:aws:bedrock:us-west-1::foundation-model/*",
          "arn:aws:bedrock:us-west-2::foundation-model/*"
         ]
        },
        {
         "Action": "lambda:InvokeFunction",
         "Effect": "Allow",
         "Resource": {
          "Fn::Join": [
           "",
           [
            "arn:aws:lambda:",
            {
             "Ref": "AWS::Region"
            },
            ":",
            {
             "Ref": "AWS::AccountId"
            },
            ":function:insuranceclaim*"
           ]
          ]
         }
        },
        {
         "Action": "dynamodb:UpdateItem",
         "Effect": "Allow",
         "Resource": {
          "Fn::Join": [
           "",
           [
            "arn:aws:dynamodb:",
            {
             "Ref": "AWS::Region"
            },
            ":",
            {
             "Ref": "AWS::AccountId"
            },
            ":table/insuranceclaim-*"
           ]
          ]
         }
        },
        {
         "Action": [
          "states:DescribeExecution",
          "states:StartExecution",
          "states:StopExecution"
         ],
         "Effect": "Allow",
         "Resource": {
          "Fn::Join": [
           "",
           [
            "arn:aws:states:",
            {
             "Ref": "AWS::Region"
            },
            ":",
            {
             "Ref": "AWS::AccountId"
            },
            ":stateMachine:insuranceclaim-*"
           ]
          ]
         }
        },
        {
         "Action": [
          "events:DescribeRule",
          "events:PutRule",
          "events:PutTargets"
         ],
         "Effect": "Allow",
         "Resource": {
          "Fn::Join": [
           "",
           [
            "arn:aws:events:",
            {
             "Ref": "AWS::Region"
            },
            ":",
            {
             "Ref": "AWS::AccountId"
            },
            ":rule/*"
           ]
          ]
         }
        },
        {
         "Action": [
          "logs:CreateLogDelivery",
          "logs:DeleteLogDelivery",
          "logs:DescribeLogGroups",
          "logs:DescribeResourcePolicies",
          "logs:GetLogDelivery",
          "logs:ListLogDeliveries",
          "logs:PutResourcePolicy",
          "logs:UpdateLogDelivery",
          "xray:GetSamplingRules",
          "xray:GetSamplingTargets",
          "xray:PutTelemetryRecords",
          "xray:PutTraceSegments"
         ],
         "Effect": "Allow",
         "Resource": "*"
        }
       ],
       "Version": "2012-10-17"
      },
      "PolicyName": "policy_doc"
     }
    ],
    "RoleName": {
     "Fn::Join": [
      "",
      [
       "insuranceclaim-ClaimProcessing-",
       {
        "Ref": "AWS::Region"
       },
       "-sfn-role"
      ]
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "InsuranceClaimProcessStack/InsuranceClaimProcessWorkflow/InsuranceClaimProcessStepFunctions/insuranceclaim-ClaimProcessing-sfn-role/Resource"
   }
  },
  "StepFunctionsLogGroupinsuranceclaimClaimProcessing65CE82DD": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "LogGroupName": "/aws/vendedlogs/states/insurance-claim-insuranceclaim-ClaimProcessing",
    "RetentionInDays": 7
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "InsuranceClaimProcessStack/InsuranceClaimProcessWorkflow/InsuranceClaimProcessStepFunctions/StepFunctionsLogGroup-insuranceclaim-ClaimProcessing/Resource"
   }
  },
  "insuranceclaimClaimProcessing": {
   "Type": "AWS::StepFunctions::StateMachine",
   "Properties": {
    "DefinitionString": {
     "Fn::Join": [
      "",
      [
       "{\n    \"Comment\": \"Insurance claim processing workflow\",\n    \"QueryLanguage\": \"JSONata\",\n    \"StartAt\": \"Wait for Upload Completion\",\n    \"States\": {\n        \"Wait for Upload Completion\": {\n            \"Type\": \"Wait\",\n            \"Seconds\": 5,\n            \"Next\": \"List Claim Documents\"\n        },\n        \"List Claim Documents\": {\n            \"Type\": \"Task\",\n            \"TimeoutSeconds\": 60,\n            \"Resource\": \"arn:aws:states:::aws-sdk:s3:listObjectsV2\",\n            \"Arguments\": {\n                \"Bucket\": \"{% $states.input.inputBucket %}\",\n                \"Prefix\": \"{% $states.input.claimId %}\"\n            },\n            \"Output\": {\n                \"listObjects\": \"{% $states.result.Contents %}\",\n                \"inputBucket\": \"{% $states.input.inputBucket %}\",\n                \"outputBucket\": \"{% $states.input.outputBucket %}\",\n                \"bdaProjectArn\": \"{% $states.input.bdaProjectArn %}\",\n                \"claimId\": \"{% $states.input.claimId %}\"\n            },\n            \"Next\": \"Process Each Document\",\n            \"Catch\": [\n                {\n                    \"ErrorEquals\": [\"States.ALL\"],\n                    \"Next\": \"Processing Failed\"\n                }\n            ]\n        },\n        \"Process Each Document\": {\n            \"Type\": \"Map\",\n            \"MaxConcurrency\": 10,\n            \"Items\": \"{% $states.input.listObjects %}\",\n            \"ItemSelector\": {\n                \"inputBucket\": \"{% $states.input.inputBucket %}\",\n                \"outputBucket\": \"{% $states.input.outputBucket %}\",\n                \"size\": \"{% $states.context.Map.Item.Value.Size %}\",\n                \"key\": \"{% $states.context.Map.Item.Value.Key %}\",\n                \"bdaProjectArn\": \"{% $states.input.bdaProjectArn %}\",\n                \"claimId\": \"{% $states.input.claimId %}\"\n            },\n            \"Output\": {\n                \"inputBucket\": \"{% $states.input.inputBucket %}\",\n                \"outputBucket\": \"{% $states.input.outputBucket %}\",\n                \"bdaProjectArn\": \"{% $states.input.bdaProjectArn %}\",\n                \"claimId\": \"{% $states.input.claimId %}\"\n            },\n            \"ItemProcessor\": {\n                \"ProcessorConfig\": {\n                    \"Mode\": \"DISTRIBUTED\",\n                    \"ExecutionType\": \"STANDARD\"\n                },\n                \"StartAt\": \"Is Folder\",\n                \"States\": {\n                    \"Is Folder\": {\n                        \"Type\": \"Choice\",\n                        \"Choices\": [\n                            {\n                                \"Condition\": \"{% $states.input.size = 0 %}\",\n                                \"Next\": \"Skip Document\"\n                            }\n                        ],\n                        \"Default\": \"Invoke BDA\"\n                    },\n                    \"Invoke BDA\": {\n                        \"Type\": \"Task\",\n                        \"TimeoutSeconds\": 300,\n                        \"Resource\": \"arn:aws:states:::aws-sdk:bedrockdataautomationruntime:invokeDataAutomationAsync\",\n                        \"Arguments\": {\n                            \"DataAutomationProfileArn\": \"arn:aws:bedrock:",
       {
        "Ref": "AWS::Region"
       },
       ":",
       {
        "Ref": "AWS::AccountId"
       },
       ":data-automation-profile/us.data-automation-v1\",\n                            \"DataAutomationConfiguration\": {\n                                \"Stage\": \"LIVE\",\n                                \"DataAutomationProjectArn\": \"{% $states.input.bdaProjectArn %}\"\n                            },\n                            \"NotificationConfiguration\": {\n                                \"EventBridgeConfiguration\": {\n                                    \"EventBridgeEnabled\": true\n                                }\n                            },\n                            \"InputConfiguration\": {\n                                \"S3Uri\": \"{% 's3://' & $states.input.inputBucket & '/' & $states.input.key %}\"\n                            },\n                            \"OutputConfiguration\": {\n                                \"S3Uri\": \"{% 's3://' & $states.input.outputBucket & '/' & $states.input.key %}\"\n                            }\n                        },\n                        \"Output\": {\n                            \"inputBucket\": \"{% $states.input.inputBucket %}\",\n                            \"claimId\": \"{% $states.input.claimId %}\",\n                            \"key\": \"{% $states.input.key %}\",\n                            \"outputBucket\": \"{% $states.input.outputBucket %}\",\n                            \"InvocationArn\": \"{% $states.result.InvocationArn %}\"\n                        },\n                        \"Next\": \"Wait for BDA\",\n                        \"Catch\": [\n                            {\n                                \"ErrorEquals\": [\"States.ALL\"],\n                                \"Next\": \"BDA Failed\"\n                            }\n                        ]\n                    },\n                    \"Wait for BDA\": {\n                        \"Type\": \"Wait\",\n                        \"Seconds\": 10,\n                        \"Next\": \"Check BDA Status\"\n                    },\n                    \"Check BDA Status\": {\n                        \"Type\": \"Task\",\n                        \"TimeoutSeconds\": 60,\n                        \"Resource\": \"arn:aws:states:::aws-sdk:bedrockdataautomationruntime:getDataAutomationStatus\",\n                        \"Arguments\": {\n                            \"InvocationArn\": \"{% $states.input.InvocationArn %}\"\n                        },\n                        \"Output\": {\n                            \"inputBucket\": \"{% $states.input.inputBucket %}\",\n                            \"claimId\": \"{% $states.input.claimId %}\",\n                            \"key\": \"{% $states.input.key %}\",\n                            \"outputBucket\": \"{% $states.input.outputBucket %}\",\n                            \"Status\": \"{% $states.result.Status %}\",\n                            \"InvocationArn\": \"{% $states.input.InvocationArn %}\"\n                        },\n                        \"Next\": \"BDA Complete\"\n                    },\n                    \"BDA Complete\": {\n                        \"Type\": \"Choice\",\n                        \"Choices\": [\n                            {\n                                \"Condition\": \"{% $states.input.Status = 'Success' %}\",\n                                \"Next\": \"Store Raw JSON\"\n                            },\n                            {\n                                \"Condition\": \"{% $states.input.Status = 'Failed' %}\",\n                                \"Next\": \"BDA Failed\"\n                            }\n                        ],\n                        \"Default\": \"Wait for BDA\"\n                    },\n                    \"Store Raw JSON\": {\n                        \"Type\": \"Task\",\n                        \"TimeoutSeconds\": 300,\n                        \"Resource\": \"arn:aws:states:::lambda:invoke\",\n                        \"Arguments\": {\n                            \"FunctionName\": \"arn:aws:lambda:",
       {
        "Ref": "AWS::Region"
       },
       ":",
       {
        "Ref": "AWS::AccountId"
       },
       ":function:insuranceclaimRawJsonProcessing\",\n                            \"Payload\": {\n                                \"inputBucket\": \"{% $states.input.inputBucket %}\",\n                                \"claimId\": \"{% $states.input.claimId %}\",\n                                \"key\": \"{% $states.input.key %}\",\n                                \"outputBucket\": \"{% $states.input.outputBucket %}\"\n                            }\n                        },\n                        \"Output\": \"{% $merge([$states.input, $states.result.Payload]) %}\",\n                        \"Next\": \"Is Image\",\n                        \"Retry\": [\n                            {\n                                \"ErrorEquals\": [\n                                    \"Lambda.ServiceException\",\n                                    \"Lambda.AWSLambdaException\",\n                                    \"Lambda.SdkClientException\",\n                                    \"Lambda.TooManyRequestsException\"\n                                ],\n                                \"IntervalSeconds\": 1,\n                                \"MaxAttempts\": 3,\n                                \"BackoffRate\": 2,\n                                \"JitterStrategy\": \"FULL\"\n                            }\n                        ],\n                        \"Catch\": [\n                            {\n                                \"ErrorEquals\": [\"States.ALL\"],\n                                \"Next\": \"Document Processing Complete\"\n                            }\n                        ]\n                    },\n                    \"Is Image\": {\n                        \"Type\": \"Choice\",\n                        \"Choices\": [\n                            {\n                                \"Condition\": \"{% $states.input.documentType = 'Disaster Damage Assessment' %}\",\n                                \"Next\": \"Detect Image Tampering\"\n                            }\n                        ],\n                        \"Default\": \"Document Processing Complete\"\n                    },\n                    \"Detect Image Tampering\": {\n                        \"Type\": \"Task\",\n                        \"TimeoutSeconds\": 300,\n                        \"Resource\": \"arn:aws:states:::lambda:invoke\",\n                        \"Arguments\": {\n                            \"FunctionName\": \"arn:aws:lambda:",
       {
        "Ref": "AWS::Region"
       },
       ":",
       {
        "Ref": "AWS::AccountId"
       },
       ":function:insuranceclaimImageTamperingDetection\",\n                            \"Payload\": {\n                                \"inputBucket\": \"{% $states.input.inputBucket %}\",\n                                \"claimId\": \"{% $states.input.claimId %}\",\n                                \"key\": \"{% $states.input.key %}\",\n                                \"outputBucket\": \"{% $states.input.outputBucket %}\"\n                            }\n                        },\n                        \"Output\": \"{% $merge([$states.result.Payload, $states.input]) %}\",\n                        \"Next\": \"Is Tampered\",\n                        \"Retry\": [\n                            {\n                                \"ErrorEquals\": [\n                                    \"Lambda.ServiceException\",\n                                    \"Lambda.AWSLambdaException\",\n                                    \"Lambda.SdkClientException\",\n                                    \"Lambda.TooManyRequestsException\"\n                                ],\n                                \"IntervalSeconds\": 1,\n                                \"MaxAttempts\": 3,\n                                \"BackoffRate\": 2,\n                                \"JitterStrategy\": \"FULL\"\n                            }\n                        ],\n                        \"Catch\": [\n                            {\n                                \"ErrorEquals\": [\"States.ALL\"],\n                                \"Next\": \"Document Processing Complete\"\n                            }\n                        ]\n                    },\n                    \"Is Tampered\": {\n                        \"Type\": \"Choice\",\n                        \"Choices\": [\n                            {\n                                \"Condition\": \"{% $states.input.fraudDetect = 1 %}\",\n                                \"Next\": \"Mark as Tampered\"\n                            }\n                        ],\n                        \"Default\": \"Document Processing Complete\"\n                    },\n                    \"Mark as Tampered\": {\n                        \"Type\": \"Task\",\n                        \"TimeoutSeconds\": 60,\n                        \"Resource\": \"arn:aws:states:::dynamodb:updateItem\",\n                        \"Arguments\": {\n                            \"TableName\": \"insuranceclaim-bda-results-raw\",\n                            \"Key\": {\n                                \"claimId\": {\n                                    \"S\": \"{% $states.input.claimId %}\"\n                                },\n                                \"name\": {\n                                    \"S\": \"{% $split($states.input.key, '/')[-1] %}\"\n                                }\n                            },\n                            \"UpdateExpression\": \"SET fraudDetection = :fraudDetection\",\n                            \"ExpressionAttributeValues\": {\n                                \":fraudDetection\": {\n                                    \"S\": \"Tampered Image\"\n                                }\n                            }\n                        },\n                        \"Next\": \"Document Processing Complete\"\n                    },\n                    \"Document Processing Complete\": {\n                        \"Type\": \"Succeed\"\n                    },\n                    \"BDA Failed\": {\n                        \"Type\": \"Fail\",\n                        \"Error\": \"BDAProcessingError\",\n                        \"Cause\": \"Bedrock Data Automation failed to process document\"\n                    },\n                    \"Skip Document\": {\n                        \"Type\": \"Succeed\"\n                    }\n                }\n            },\n            \"Next\": \"Prepare Report Prompt\",\n            \"Catch\": [\n                {\n                    \"ErrorEquals\": [\"States.ALL\"],\n                    \"Next\": \"Processing Failed\"\n                }\n            ]\n        },\n        \"Prepare Report Prompt\": {\n            \"Type\": \"Task\",\n            \"TimeoutSeconds\": 300,\n            \"Resource\": \"arn:aws:states:::lambda:invoke\",\n            \"Arguments\": {\n                \"FunctionName\": \"arn:aws:lambda:",
       {
        "Ref": "AWS::Region"
       },
       ":",
       {
        "Ref": "AWS::AccountId"
       },
       ":function:insuranceclaimJsonReportGeneration\",\n                \"Payload\": \"{% $states.input %}\"\n            },\n            \"Output\": \"{% $merge([$states.input, {'prompt': $states.result.Payload}]) %}\",\n            \"Next\": \"Generate JSON Report\",\n            \"Retry\": [\n                {\n                    \"ErrorEquals\": [\n                        \"Lambda.ServiceException\",\n                        \"Lambda.AWSLambdaException\",\n                        \"Lambda.SdkClientException\",\n                        \"Lambda.TooManyRequestsException\"\n                    ],\n                    \"IntervalSeconds\": 1,\n                    \"MaxAttempts\": 3,\n                    \"BackoffRate\": 2,\n                    \"JitterStrategy\": \"FULL\"\n                }\n            ],\n            \"Catch\": [\n                {\n                    \"ErrorEquals\": [\"States.ALL\"],\n                    \"Next\": \"Processing Complete\"\n                }\n            ]\n        },\n        \"Generate JSON Report\": {\n            \"Type\": \"Task\",\n            \"TimeoutSeconds\": 600,\n            \"Resource\": \"arn:aws:states:::aws-sdk:bedrockruntime:converse\",\n            \"Arguments\": {\n                \"ModelId\": \"us.amazon.nova-pro-v1:0\",\n                \"InferenceConfig\": {\n                    \"MaxTokens\": 4096,\n                    \"Temperature\": 0.2,\n                    \"TopP\": 0.2\n                },\n                \"System\": \"{% $states.input.prompt.body.system %}\",\n                \"Messages\": \"{% $states.input.prompt.body.messages %}\"\n            },\n            \"Output\": \"{% $merge([$states.result, {'claimId': $states.input.claimId}]) %}\",\n            \"Next\": \"Store JSON Report\",\n            \"Catch\": [\n                {\n                    \"ErrorEquals\": [\"States.ALL\"],\n                    \"Next\": \"Processing Complete\"\n                }\n            ]\n        },\n        \"Store JSON Report\": {\n            \"Type\": \"Task\",\n            \"TimeoutSeconds\": 300,\n            \"Resource\": \"arn:aws:states:::lambda:invoke\",\n            \"Arguments\": {\n                \"FunctionName\": \"arn:aws:lambda:",
       {
        "Ref": "AWS::Region"
       },
       ":",
       {
        "Ref": "AWS::AccountId"
       },
       ":function:insuranceclaim-PutItemDynamodb\",\n                \"Payload\": {\n                    \"dynamodbTable\": \"insuranceclaim-reports-json\",\n                    \"body\": \"{% $parse($replace($replace($states.input.Output.Message.Content[0].Text,'```json\\\\n', ''), '```','')) %}\"\n                }\n            },\n            \"Next\": \"Processing Complete\",\n            \"Retry\": [\n                {\n                    \"ErrorEquals\": [\n                        \"Lambda.ServiceException\",\n                        \"Lambda.AWSLambdaException\",\n                        \"Lambda.SdkClientException\",\n                        \"Lambda.TooManyRequestsException\"\n                    ],\n                    \"IntervalSeconds\": 1,\n                    \"MaxAttempts\": 3,\n                    \"BackoffRate\": 2,\n                    \"JitterStrategy\": \"FULL\"\n                }\n            ],\n            \"Catch\": [\n                {\n                    \"ErrorEquals\": [\"States.ALL\"],\n                    \"Next\": \"Processing Complete\"\n                }\n            ]\n        },\n        \"Processing Complete\": {\n            \"Type\": \"Succeed\"\n        },\n        \"Processing Failed\": {\n            \"Type\": \"Fail\",\n            \"Error\": \"ClaimProcessingError\",\n            \"Cause\": \"Failed to process insurance claim\"\n        }\n    }\n}\n"
      ]
     ]
    },
    "LoggingConfiguration": {
     "Destinations": [
      {
       "CloudWatchLogsLogGroup": {
        "LogGroupArn": {
         "Fn::GetAtt": [
          "StepFunctionsLogGroupinsuranceclaimClaimProcessing65CE82DD",
          "Arn"
         ]
        }
       }
      }
     ],
     "IncludeExecutionData": false,
     "Level": "ALL"
    },
    "RoleArn": {
     "Fn::GetAtt": [
      "insuranceclaimClaimProcessingsfnroleC70596EF",
      "Arn"
     ]
    },
    "StateMachineName": "insuranceclaim-ClaimProcessing",
    "TracingConfiguration": {
     "Enabled": true
    }
   },
   "Metadata": {
    "aws:cdk:path": "InsuranceClaimProcessStack/InsuranceClaimProcessWorkflow/InsuranceClaimProcessStepFunctions/insuranceclaim-ClaimProcessing"
   }
  },
  "CDKMetadata": {
   "Type": "AWS::CDK::Metadata",
   "Properties": {
    "Analytics": "v2:deflate64:H4sIAAAAAAAA/zWMwQ7CIBBEv6V3WMV68O7BixqDH2CQ0nYtZZsCMYb0393GeHqTmbzZgTrUsK3MO0rbDNLjE8rVxeSaezJ2EDw8CpoRiibvxLENKxfhqYtQztSdZsrT2v/zItie2hxsQgoReOKr5C7G9hhY1S5Sni2n2yf1FDY1KAVqX70iopxzSDg60D9+ASwUIaChAAAA"
   },
   "Metadata": {
    "aws:cdk:path": "InsuranceClaimProcessStack/InsuranceClaimProcessWorkflow/InsuranceClaimProcessStepFunctions/CDKMetadata/Default"
   },
   "Condition": "CDKMetadataAvailable"
  }
 },
 "Conditions": {
  "CDKMetadataAvailable": {
   "Fn::Or": [
    {
     "Fn::Or": [
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "af-south-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-east-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-northeast-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-northeast-2"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-northeast-3"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-south-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-south-2"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-southeast-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-southeast-2"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-southeast-3"
       ]
      }
     ]
    },
    {
     "Fn::Or": [
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ap-southeast-4"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ca-central-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "ca-west-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "cn-north-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "cn-northwest-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-central-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-central-2"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-north-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-south-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-south-2"
       ]
      }
     ]
    },
    {
     "Fn::Or": [
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-west-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-west-2"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "eu-west-3"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "il-central-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "me-central-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "me-south-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "sa-east-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "us-east-1"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "us-east-2"
       ]
      },
      {
       "Fn::Equals": [
        {
         "Ref": "AWS::Region"
        },
        "us-west-1"
       ]
      }
     ]
    },
    {
     "Fn::Equals": [
      {
       "Ref": "AWS::Region"
      },
      "us-west-2"
     ]
    }
   ]
  }
 }
}